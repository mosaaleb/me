---
slug: rails-polymorphic-routes
title: When in doubt, use polymorphic_url
author: Muhammad Ebeid
description: refactor your rails routes using polymorphic_rul
date: "2020-08-19T19:47:40.786Z"
categories:
  - Rails
  - Polymorphism
  - Routes
---
Rails polymorphic routes are a smart way to generate paths for Active Record
model instances. Suppose that you are working on an application that allows
multiple models to be liked.

For example if you have `Post` and `Comment` models, that could be liked by a
user, to generate the routes for liking a post or a comment, it could be like:

```ruby
# routes
resources :post do
  member do
    post 'like', to: 'likes#create'
    delete 'dislike', to: 'likes#destroy'
  end
end

resources :comment do
  member do
    post 'like', to: 'likes#create'
    delete 'dislike', to: 'likes#destroy'
  end
end
```

These routes could be refactored by using, but for the sake of this post, let's
keep it that way.
[concerns](https://edgeguides.rubyonrails.org/routing.html#routing-concerns)

Also, I prefer using member routes here, because it generates more meaningful
paths in this particular case. Consider having `like_post_path` instead of `post_likes_path`
if you used nested resources. The path name also reflects that action being taken
by the user.

Another reason for using member routes, because i personally find it more easy to remember path names.

Now if you want to generate path for liking and disliking a post or a comment, you will have to check
if the likable is a `post` or a `comment` to generate the right path for it.

```ruby
# paths for liking or disliking a post
link_to 'like', like_post_path(@post), method: :post
link_to 'dislike', dislike_post_path(@post), method: :delete

# paths for liking or disliking a comment
link_to 'like', like_comment_path(@post), method: :post
link_to 'dislike', dislike_comment_path(@post), method: :delete
```

But with using `polymorphic_path`, this can be refactored into:

```ruby
link_to 'like', polymorphic_path([:like, likable]), method: :post
link_to 'dislike', polymorphic_path([:dislike, likable]), method: :delete
```

Now you don't care what you are generating this path for, Rails will take care of it.


